<div id="connect-box" style="position:fixed; top:10px; left:10px; background:#222; color:#fff; padding:15px; border-radius:10px; cursor:pointer; z-index:999;">
  Odaya Bağlan
</div>

<div id="controls" style="position:fixed; bottom:20px; left:20px; display:none; z-index:999;">
  <button onclick="toggleMic()">Mikrofon Aç/Kapat</button>
  <button onclick="leaveRoom()">Çık</button>
</div>

<div id="jitsi-container" style="width: 1px; height: 1px; overflow: hidden;"></div>

<script src="https://meet.jit.si/external_api.js"></script>
<script>
  let api = null;

  document.getElementById("connect-box").onclick = function () {
    if (api) return;

    const domain = "meet.jit.si";
    const options = {
      roomName: "TeazerEngines", // Dilersen random üret
      width: 1,
      height: 1,
      parentNode: document.getElementById("jitsi-container"),
      configOverwrite: {
        startWithVideoMuted: true,
        startWithAudioMuted: false,
        prejoinPageEnabled: false,
      },
      interfaceConfigOverwrite: {
        TOOLBAR_BUTTONS: [],
        SHOW_JITSI_WATERMARK: false,
        SHOW_WATERMARK_FOR_GUESTS: false,
      }
    };

    api = new JitsiMeetExternalAPI(domain, options);

    api.addEventListener("videoConferenceJoined", () => {
      document.getElementById("connect-box").style.display = "none";
      document.getElementById("controls").style.display = "block";
    });
  };

  function toggleMic() {
    if (api) {
      api.isAudioMuted().then((muted) => {
        api.executeCommand("toggleAudio");
      });
    }
  }

  function leaveRoom() {
    if (api) {
      api.executeCommand("hangup");
      api = null;
      document.getElementById("controls").style.display = "none";
      document.getElementById("connect-box").style.display = "block";
    }
  }
</script>
